@startuml SQ
autonumber
title SD40.2. Sửa khách hàng

actor "Actor" as actor
boundary "ManagecustomerView" as manageView
control "customerController" as controller
entity "customerRepository" as model
database "Database" as database

activate actor
actor -> manageView : Select a customer to edit
activate manageView

manageView -> controller : Request customer details
activate controller

controller -> model : Inject repository
activate model

model -> database : findById()
activate database
database --> model : Return customer details
deactivate database
deactivate database

model --> controller : Return details
deactivate model
deactivate model

controller --> manageView : Render edit form
deactivate controller
deactivate controller

actor -> manageView : Input updated fullName, username, email, address, phoneNumber, group, password, confirm password

manageView -> manageView : Validate fields
alt Invalid input
    manageView -> actor : Show validation errors\n(Empty: fullName, username, email, address, phoneNumber, group, password, confirm password)
    deactivate manageView
    deactivate actor
else Valid input
    manageView -> controller : Submit edit form
    activate controller

    controller -> model : Inject repository
    activate model

    model -> database : save(customer)
    activate database
    database --> model : Update success
    deactivate database
    deactivate database

    model --> controller : Notify success
    deactivate model
    deactivate model

    controller --> manageView : Return success
    deactivate controller
    deactivate controller

    manageView -> actor : Notify "customer updated successfully"
    manageView -> manageView : Display customer list
end

deactivate manageView
deactivate actor
@enduml
