@startuml SQ
autonumber
title SD42.1. Thêm khách hàng

actor "Actor" as actor
boundary "ManageCustomerView" as manageView
control "customerController" as controller
entity "customerRepository" as model
database "Database" as database

activate actor
actor -> manageView : Click "Thêm mới"
activate manageView

manageView -> actor : Display create form
actor -> manageView : Input customer (fullName, username, email, address, phoneNumber, group, password, confirm password)

manageView -> manageView : Validate fields
alt Invalid input
    manageView -> actor : Show validation errors\n(Empty: fullName, username, email, phoneNumber, password, confirmPassword, group)
    deactivate manageView
    deactivate actor
else Valid input
    manageView -> controller : Submit create form
    activate controller

    controller -> model : Inject repository
    activate model

    model -> database : INSERT INTO customers (fullName, username, email, address, phoneNumber, group, passwordHash)
    activate database
    database --> model : Insert success
    deactivate database

    model --> controller : Notify success
    deactivate model

    controller --> manageView : Return success
    deactivate controller

    manageView -> actor : Notify "customer created successfully"
    manageView -> manageView : Refresh customer list
end

deactivate manageView
deactivate actor
@enduml
